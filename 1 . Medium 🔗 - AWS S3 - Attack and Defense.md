<p align="center">May 13, 2025<br>
Hey there, fellow lifelong learner! I¬¥m <a href="https://www.linkedin.com/in/rosanafssantos/">Rosana</a>, and I‚Äôm genuinely excited to join you on this adventure.<br>
It¬¥s part of my $$\textcolor{#FF69B4}{\textbf{373}}$$-day-streak in  <a href="https://tryhackme.com">TryHackMe</a>.<br><br>
<img width="300px" src="https://github.com/user-attachments/assets/3e7f2867-802a-4bc8-9066-a37cc667909a" alt="Your Image Badge"></p>
<h1 align="center"> $$\textcolor{#3bd62d}{\textnormal{AWS S3 - Attack and Defense}}$$</h1>
<p align="center"><em>An overview of security features and common attacks for the AWS S3 service.</em>.<br>
It is classified as a medium-level walkthrough.<br>
You can join it for üÜì using your own virtual machine with openVPN or TryHackMe¬¥s AttackBox if you are subscribed.<br>
Can be accessed clicking  <a href="https://tryhackme.com/room/awss3service"</a>here.</p>

<p align="center"> <img width="1000px" src="https://github.com/user-attachments/assets/597ef441-7af4-466c-a221-ddd8a037fc1d"> </p>

<br>
<br>


<h2 align="center">Read my complete walkthrough in Medium.</h2>
<h3 align="center"> Click here ‚û°Ô∏è  <a href="https://medium.com/@RosanaFS/aws-vpc-attack-and-defense-tryhackme-walkthrough-991cd64b473c">AWS VPC - Attack and Defense</a></h3>


<br>
<br>

<h2>Task 1 . Introduction</h2>
<h3>ÔªøS3 - A Versatile Service </h3>
<p>AWS S3 helped set AWS apart as a powerhouse in cloud computing. Being able to arbitrarily scale data storage and use it in interactions across AWS services has meant that S3 is deeply entangled in how almost all organizations use AWS. However, that power doesn't come without its own weaknesses - S3 is one of the most commonly abused services in AWS. During this room, you will learn key capabilities and attack surfaces of S3.</p>

<h3>Learning Objectives</h3>
<p>Students will learn basic S3 concepts, such as:<br>

- buckets<br>
- objects<br>
- ACLs<br>
- bucket policies<br><br>

Students will learn about common security issues related to public S3 buckets and how S3 buckets are used in automation. Finally, students will use this knowledge to attack an S3 bucket, exfiltrating data and using the data to further compromise an organization.</p>

<h3 align="left"> $$\textcolor{#f00c17}{\textnormal{Answer the question below}}$$ </h3>
<br>

> 1.1. <em>Let¬¥s get started!</em><br><a id='1.1'></a>
>> <code><strong>No answer needed</strong></code>

<br>
<br>

<h2>Task 2 . Accessing the environment</h2>

<h3 align="left"> $$\textcolor{#f00c17}{\textnormal{Answer the question below}}$$ </h3>
<br>

> 2.1. <em>Generate environment or set up your credentials</em><br><a id='2.1'></a>
>> <code><strong>No answer needed</strong></code>

<br>

![image](https://github.com/user-attachments/assets/823c8278-eb38-4513-a790-e140af6ad073)

<br>

<h2>Task 3 . S3 Service Overview</h2>

<h3 align="left"> $$\textcolor{#f00c17}{\textnormal{Answer the questions below}}$$ </h3>
<br>

> 3.1. <em>What is the name of the file storage container where you keep your data in S3?</em><br><a id='3.1'></a>
>> <code><strong>bucket</strong></code>

<br>

> 3.2. <em>What characteristic makes Bucket Policies preferable to ACLs in S3?</em><br><a id='3.2'></a>
>> <code><strong>human-readable-syntax</strong></code>

<br>
<br>

<h2>Task 4 . CloudFront Overview</h2>

<h3 align="left"> $$\textcolor{#f00c17}{\textnormal{Answer the question below}}$$ </h3>
<br>

> 4.1. <em>What are the CloudFront origins?</em><br><a id='4.1'></a>
>> <code><strong>The resource hosted behind CloudFront</strong></code>

<br>

<br>

<h2>Task 5 . Lab: Identifying Misconfigured CloudFront Distrubtions</h2>

<h3 align="left"> $$\textcolor{#f00c17}{\textnormal{Answer the question below}}$$ </h3>
<br>

> 5.1. <em>What are the two primary methods of identifying public S3 buckets?</em><br><a id='5.1'></a>
>> <code><strong>Search Engine Indexing and DNS Recon</strong></code>

<br>

> 5.2. <em>What subdomain did we identify by searching certificates at crt.sh?</em><br><a id='5.2'></a>
>> <code><strong>assets.bestcloudcompany.org</strong></code>

<br>

```bash
:~# nslookup bestcloudcompany.org
Server:		127.0.0.53
Address:	127.0.0.53#53

Non-authoritative answer:
Name:	bestcloudcompany.org
Address: 44.203.62.152

:~# nslookup 44.203.62.152
152.62.203.44.in-addr.arpa	name = ec2-44-203-62-152.compute-1.amazonaws.com.

Authoritative answers can be found from:
```

<br>

```bash
:~# nslookup assets.bestcloudcompany.org
Server:		127.0.0.53
Address:	127.0.0.53#53

Non-authoritative answer:
Name:	assets.bestcloudcompany.org
Address: 18.66.171.33
Name:	assets.bestcloudcompany.org
Address: 18.66.171.68
Name:	assets.bestcloudcompany.org
Address: 18.66.171.7
Name:	assets.bestcloudcompany.org
Address: 18.66.171.86

:~# nslookup 18.66.171.33
33.171.66.18.in-addr.arpa	name = server-18-66-171-33.dub56.r.cloudfront.net.

Authoritative answers can be found from:

:~# 
```

<br>

<p>Added <code>18.66.171.86</code> to <code>/etc/hosts</code>.</p>

<p>Navigated to <code>assets.bestcloudcompany.org</code>.</p>

<br>

![image](https://github.com/user-attachments/assets/902f0578-945b-43b0-b0c0-cd0db43772c4)

<br>

<p>Googled <code>"bestcloudcompany.org" AND "s3.amazonaws.com"</code></p>

![image](https://github.com/user-attachments/assets/daa2b050-c767-4f09-8e1a-03d407f01e7b)

<br>

```bash
:~# nslookup assets.bestcloudcompany.org.org.s3.amazonaws.com
Server:		127.0.0.53
Address:	127.0.0.53#53

Non-authoritative answer:
assets.bestcloudcompany.org.org.s3.amazonaws.com	canonical name = s3-1-w.amazonaws.com.
s3-1-w.amazonaws.com	canonical name = s3-w.us-east-1.amazonaws.com.
Name:	s3-w.us-east-1.amazonaws.com
Address: 52.217.104.36
Name:	s3-w.us-east-1.amazonaws.com
Address: 3.5.3.117
Name:	s3-w.us-east-1.amazonaws.com
Address: 16.15.185.155
Name:	s3-w.us-east-1.amazonaws.com
Address: 16.182.96.249
Name:	s3-w.us-east-1.amazonaws.com
Address: 52.217.199.241
Name:	s3-w.us-east-1.amazonaws.com
Address: 3.5.29.56
Name:	s3-w.us-east-1.amazonaws.com
Address: 3.5.30.235
Name:	s3-w.us-east-1.amazonaws.com
Address: 3.5.29.172
:~# 
```

<br>
<br>


<h2>Task 6 . Lab: Attacking Public S3 Buckets</h2>
<h3>Public S3 Buckets - A Long HistoryÔªø</h3>
<p>As mentioned, a primary use case for S3 is to host public websites. While this is intended behavior by AWS design, it hasn't been without significant security breaches at AWS customers. In fact, customers were so commonly leaving sensitive data in open S3 buckets, AWS changed default behavior from allowing any bucket to be made public by default, to instituting a "Public Access Block" on all newly created S3 buckets across AWS customers. This "Public Access Block" became the default behavior in AWS accounts starting in November 2018.<br><br>

However, the control was not implemented retroactively. Any buckets or associated objects made public prior to November 2018 remain public. Furthermore, customers still make mistakes with S3 bucket permissions in spite of the Public Access Block - cloud security researcher Christophe Tafani-Dereeper found that in 2021, there were at least 22 publicly disclosed cybersecurity incidents involving public S3 buckets. </p>

<h3>Getting S3 Loot</h3>
<p>Even though S3 buckets often contain sensitive information, it doesn't mean that everything in a bucket is sensitive. Furthermore, while individual file  (or "objects") uploads are limited to 5 TB; buckets can be arbitrarily large. As an attacker, even if you find an open bucket - you may be searching through a proverbial needle in a haystack.</p>

<h3>Using AWS Utilities for Offense</h3>
<p>On your attack box, the AWS CLI comes pre-installed. If you are using your own machine, you can download and install the AWS CLI using this guide from AWS. Using the AWS CLI, enter the following command to dump the S3 bucket that you have found open:</p>

<p>[ ... ]</p>

<h3 align="left"> $$\textcolor{#f00c17}{\textnormal{Answer the question below}}$$ </h3>
<br>

> 6.1. <em>What AWS CLI command can you run to dump an S3 bucket in its entirety?</em><br><a id='6.1'></a>
>> <code><strong>aws s3 sync</strong></code>

<br>

```bash
:~# aws configure
AWS Access Key ID [None]: AKIA***************
AWS Secret Access Key [None]: *********************************************************
Default region name [None]: us-east-1
Default output format [None]: json
```

<br>

```bash
:~# aws s3 sync s3://assets.bestcloudcompany.org . --no-sign-request
...
download: s3://assets.bestcloudcompany.org/index.html to ./index.html
download: s3://assets.bestcloudcompany.org/media/cdx_at_cga_1.jpg to media/cdx_at_cga_1.jpg
download: s3://assets.bestcloudcompany.org/media/cyber_cyber.jpeg to media/cyber_cyber.jpeg
download: s3://assets.bestcloudcompany.org/media/hacking_hacker_computer_internet.jpg to media/hacking_hacker_computer_internet.jpg
download: s3://assets.bestcloudcompany.org/media/cyber_guard_2016_1.jpg to media/cyber_guard_2016_1.jpg
download: s3://assets.bestcloudcompany.org/ami-056a6742115906e8c.bin to ./ami-056a6742115906e8c.bin
```

<br>

![image](https://github.com/user-attachments/assets/388fab17-be54-430a-9340-711b035d2ad3)

<br>

![image](https://github.com/user-attachments/assets/4e0e61ae-4763-4413-87e4-332038161150)

<br>

![image](https://github.com/user-attachments/assets/b9ef5023-27f9-462a-b062-3102fb8f4a89)

<br>

<br>


![image](https://github.com/user-attachments/assets/bbf2258d-6609-491b-9cb3-9370feea7881)

<br>

![image](https://github.com/user-attachments/assets/996bfef7-18d4-4e86-911a-ad29043cc545)




<br>
<br>


<h2>Task 7 . S3: AWS Service Substrate</h2>

AWS Service Substrate<br>

<br>
<br>


<h2>Task 8 . Lab: S3 - Abusing the Substrate</h2>

<br>


![image](https://github.com/user-attachments/assets/bbf2258d-6609-491b-9cb3-9370feea7881)


<br>
<br>


![image](https://github.com/user-attachments/assets/01664c46-283e-48be-be15-1e3930b2ce23)


![image](https://github.com/user-attachments/assets/2eda61bb-e812-459e-87c5-010f8fe1be2a)


<br>
<br>

<h1 align="center">$$\textcolor{#3bd62d}{\textnormal{My TryHackMe Journey}}$$</h1>

<div align="center">

| Date              | Streak   | All Time     | All Time     | Monthly     | Monthly    | Points   | Rooms     | Badges    |
| :---------------: | :------: | :----------: | :----------: | :---------: | :--------: | :------  | :-------: | :-------: |
|                   |          |   Global     |   Brazil     |   Global    |   Brazil   |          | Completed |           |
| May 14, 2025      | 373      |    227·µó ∞     |        5·µó ∞   |   242nd     |    5·µó ∞    |  101,967 |       7230|   62      |

</div>

![image](https://github.com/user-attachments/assets/f0a838a5-bc03-433c-8d40-10bb88d8b805)

<br>

![image](https://github.com/user-attachments/assets/5a1bd886-486a-4ee8-83e2-77a828613f4a)

<br>

![image](https://github.com/user-attachments/assets/a945a064-0dc4-4821-bfd2-36c3ec4807e2)

<br>

![image](https://github.com/user-attachments/assets/f0a439c1-bde5-4952-84b4-3f920bb0e9be)



